Выгрузка данных из OSM послойно в NGW (data.nextgis.com)

Написать сразу универсальный скрипт с автоматическим обновлением оказалось проще, чем выгружать данные вручную.

Алгоритм
=======================

Задача состоит в регулярной выгрузке из OSM в отдельные слои в ngw разных фич. 



* При первом запуске скрипта выкачивается планета. По крону (раз в неделю) запускаются отдельные скрипты, по одному на каждый слой. 

* Скрипт через osmupdate обновляет свой отфильтрованный локальный дамп, 
* затем фильтрует его по тегам ещё раз, и оставляет на диске до следующей недели. 
* Отфильтрованный дамп импортируется в PostGIS с заменой всех таблиц.
* Данные фильтруются, на этом шаге возможна постобработка скриптом типа osmot
* Слой выгружается в geojson, и с ним синхронизируется слой в ngw (потом можно будет заменить на более технологичный скрипт синхронизации, чтоб брал сразу из PostGIS, но был готовый скрипт)

* После завершения работы всех скриптов очищается папка с файлами osc.

Такой алгоритм был выбран что бы:

1. Избежать двухдневного начального импортирования базы
2. Избежать необходимости двухдневного импортирования всей базы при необходимости добавления новых тегов.

Выгрузка каждого слоя выполняется отдельным скриптом, таким образом легко добавлять новые слои и теги. 
osmupdate запускается для каждого скрипта по-очереди, но они вроде бы используют общую папку с загруженными osс-файлами. 


Структура
============================

Для каждой выгрузки нужны отдельные





В корне лежат

* update_ngw_from_geojson.py

В папках для каждой выгрузки лежат

* конфиг с id слоя
* стиль osm2pgsql
* строка фильтра
* возможность запуска скриптов


Выгрузка столиц
-------------------------

В слое должны быть столицы административных образований.
Затем к этому слою будут делаться стили - показывать только столицы стран, или же все столицы административных образований кружками, а столицы стран - звёздочкаи.

Нужные теги:
--------------

capital
    Если capital=yes, то это столица страны
    Если capital-цифра, то это столица административного образования
admin_level
    Уровень административного подчинения населённого пункта
name
name:ru
